<!-- Button trigger modal -->
<div class="row">
  <button type="button" class="btn btn-primary btn-add" data-bs-toggle="modal" data-bs-target="#user-modal">
    Add user
  </button>
</div>

<!-- Modal -->
<div class="modal fade" id="user-modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">

      <div data-reflex-root='#user-form' data-controller="validations" data-action="ajax:success->validations#reload" >
        <%= form_with model: @user, class: "mt-4", id: 'user-form', remote: true, data: { action: "submit->validations#test" } do |f| %>

          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>

          <div class="modal-body">

            <div class="mb-3 <%= validation_status @user, :name %>">
              <%= f.label :name, "Name*", class: 'form-label' %>
              <%= f.text_field :name, class: "form-control",
                  data: { reflex: "debounced:input", reflex_permanent: true } %>
              <%= validation_message @user, :name %>
            </div>

            <div class="mb-3 <%= validation_status @user, :email %>">
              <%= f.label :email, "Email*", class: 'form-label' %>
              <%= f.email_field :email, class: "form-control",
                  data: { reflex: "debounced:input", reflex_permanent: true } %>
              <%= validation_message @user, :email %>
            </div>

            <div class="mb-3>">
              <%= f.label :title, class: 'form-label' %>
              <%= f.text_field :title, class: "form-control",
                  data: { reflex_permanent: true } %>
            </div>

            <div class="mb-3 <%= validation_status @user, :phone %>">
              <%= f.label :phone, 'Phone*', class: 'form-label' %>
              <%= f.text_field :phone, class: "form-control",
                  data: { reflex: "debounced:input", reflex_permanent: true } %>
              <%= validation_message @user, :phone %>
            </div>

            <div class="mb-3 form-check">
              <%= f.check_box :active, class: 'form-check-input' %>
              <%= f.label :active, class: 'form-check-label', data: { reflex_permanent: true } %>
            </div>

          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <%= f.submit @user.valid? ? "Submit" : "Awaiting valid input...",
                class: "btn #{ @user.valid? ? 'btn-primary' : 'btn-secondary'}",
                disabled: @user.invalid?,
                data: { disable_with: "Adding..." } %>
          </div>

        <% end %>
      </div>


    </div>
  </div>
</div>
